<% content_for :title, @plan.name %>

<div class="px-4 py-10 sm:px-6 lg:px-8">
  <div class="mx-auto max-w-4xl space-y-8">
    <div class="flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between">
      <div>
        <%= link_to "Back to plans", plans_path, class: "inline-flex items-center gap-2 text-sm font-semibold text-indigo-600 hover:text-indigo-500 dark:text-indigo-400 dark:hover:text-indigo-300" %>
        <h1 class="mt-4 text-3xl font-semibold text-gray-900 dark:text-white"><%= @plan.name %></h1>
        <p class="mt-2 text-sm text-gray-600 dark:text-gray-300">Core plan information at a glance.</p>
      </div>

      <div class="flex items-center gap-3">
        <%= button_to "Edit in plan wizard",
                      wizard_progresses_path(plan_id: @plan.id, wizard_type: "plan_creation"),
                      method: :post,
                      form: { class: "inline" },
                      class: "inline-flex items-center gap-2 rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-xs hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 dark:bg-indigo-500 dark:hover:bg-indigo-400 dark:focus-visible:outline-indigo-500",
                      data: { turbo: true, test_id: "edit-plan-with-wizard-button" } %>
        <%= button_to "Create new version",
                      wizard_progresses_path(plan_id: @plan.id, wizard_type: "plan_creation", new_version: true),
                      method: :post,
                      form: { class: "inline" },
                      class: "inline-flex items-center gap-2 rounded-md border border-indigo-200 bg-indigo-50 px-3 py-2 text-sm font-semibold text-indigo-700 shadow-xs hover:bg-indigo-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 dark:border-indigo-500/40 dark:bg-indigo-500/10 dark:text-indigo-100 dark:hover:bg-indigo-500/20 dark:focus-visible:outline-indigo-500",
                      data: { turbo: true, test_id: "create-plan-version-with-wizard-button" } %>
      </div>
    </div>

    <div class="overflow-hidden rounded-xl border border-gray-200 bg-white shadow-sm dark:border-white/10 dark:bg-gray-900">
      <dl class="divide-y divide-gray-200 text-sm text-gray-700 dark:divide-white/10 dark:text-gray-200">
        <div class="grid gap-2 px-6 py-4 sm:grid-cols-2">
          <dt class="font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400">Insurer</dt>
          <dd><%= @plan.insurer&.name || "Unassigned" %></dd>
        </div>
        <div class="grid gap-2 px-6 py-4 sm:grid-cols-2">
          <dt class="font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400">Policy type</dt>
          <dd><%= @plan.policy_type&.humanize || "Not set" %></dd>
        </div>
        <div class="grid gap-2 px-6 py-4 sm:grid-cols-2">
          <dt class="font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400">Version year</dt>
          <dd><%= @plan.version_year %></dd>
        </div>
        <div class="grid gap-2 px-6 py-4 sm:grid-cols-2">
          <dt class="font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400">Min age</dt>
          <dd><%= @plan.min_age %></dd>
        </div>
        <div class="grid gap-2 px-6 py-4 sm:grid-cols-2">
          <dt class="font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400">Max age</dt>
          <dd><%= @plan.max_age || "Not set" %></dd>
        </div>
        <div class="grid gap-2 px-6 py-4 sm:grid-cols-2">
          <dt class="font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400">Next review due</dt>
          <dd><%= @plan.next_review_due&.strftime("%Y-%m-%d") || "Not set" %></dd>
        </div>
        <div class="grid gap-2 px-6 py-4 sm:grid-cols-2">
          <dt class="font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400">Last reviewed at</dt>
          <dd><%= @plan.last_reviewed_at&.strftime("%Y-%m-%d") || "Not set" %></dd>
        </div>
        <div class="grid gap-2 px-6 py-4 sm:grid-cols-2">
          <dt class="font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400">Published?</dt>
          <dd><%= @plan.published? ? "Yes" : "No" %></dd>
        </div>
        <div class="grid gap-2 px-6 py-4 sm:grid-cols-2">
          <dt class="font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400">Children only?</dt>
          <dd><%= @plan.children_only_allowed? ? "Yes" : "No" %></dd>
        </div>
        <div class="px-6 py-4">
          <dt class="font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400">Review notes</dt>
          <dd class="mt-2 text-gray-700 dark:text-gray-200"><%= @plan.review_notes.presence || "No notes provided." %></dd>
        </div>
      </dl>
    </div>
  </div>
</div>
