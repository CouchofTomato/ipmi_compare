<%# app/views/comparison/plan_selections/_plan_search_results.html.erb %>
<% if plans.present? %>
  <ul class="space-y-4">
    <% plans.each do |plan| %>
      <li class="rounded-xl border border-slate-200 bg-white shadow-sm transition hover:-translate-y-0.5 hover:shadow-md dark:border-slate-700 dark:bg-slate-900 dark:hover:shadow-lg">
        <%= form_with(url: add_comparison_plan_selection_path(wizard_progress), method: :post) do |f| %>
          <%= f.hidden_field :plan_id, value: plan.id %>
          <div class="flex flex-wrap items-start justify-between gap-3 border-b border-slate-100 p-4 dark:border-slate-800">
            <div class="space-y-1">
              <div class="text-sm font-semibold text-slate-900 dark:text-slate-100"><%= plan.name %></div>
              <div class="text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400"><%= plan.insurer.name %></div>
            </div>
            <div class="flex items-center gap-2">
              <%= f.submit "Configure modules", class: "rounded-md bg-indigo-600 px-3 py-2 text-xs font-semibold text-white shadow transition hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-slate-900" %>
            </div>
          </div>

          <div class="space-y-3 p-4">
            <div class="flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400">
              <span class="h-1.5 w-10 rounded-full bg-indigo-500 dark:bg-indigo-400"></span>
              Modules by category
            </div>
            <div class="grid gap-3 md:grid-cols-2">
              <% plan.module_groups.each do |group| %>
                <div class="rounded-lg border border-slate-100 bg-slate-50/60 p-3 dark:border-slate-800 dark:bg-slate-800/60">
                  <div class="flex items-start justify-between gap-2">
                    <div>
                      <p class="text-sm font-semibold text-slate-900 dark:text-slate-100"><%= group.name %></p>
                      <p class="text-[11px] uppercase tracking-wide text-slate-500 dark:text-slate-400">Select one</p>
                    </div>
                    <span class="rounded-full bg-white px-2 py-0.5 text-[10px] font-semibold text-slate-600 shadow-inner dark:bg-slate-900 dark:text-slate-200">Group <%= group.position %></span>
                  </div>
                  <ul class="mt-2 space-y-1.5">
                    <% group.plan_modules.each do |plan_module| %>
                      <li>
                        <label class="flex items-center justify-between gap-3 rounded-md bg-white px-2.5 py-2 text-xs text-slate-800 shadow-sm transition hover:border hover:border-indigo-100 hover:shadow dark:bg-slate-900 dark:text-slate-100 dark:hover:border-indigo-400/30">
                          <span class="flex items-center gap-2">
                            <%= radio_button_tag "module_groups[#{group.id}]", plan_module.id, false, class: "h-3.5 w-3.5 border-slate-300 text-indigo-600 focus:ring-indigo-500 dark:border-slate-600" %>
                            <span class="font-medium"><%= plan_module.name %></span>
                          </span>
                          <span class="text-[11px] font-semibold text-emerald-600 dark:text-emerald-400">Choose</span>
                        </label>
                      </li>
                    <% end %>
                  </ul>
                </div>
              <% end %>
            </div>
          </div>
          <div class="border-t border-slate-100 bg-slate-50/60 px-4 py-3 dark:border-slate-800 dark:bg-slate-900/80">
            <%= f.submit "Add to Comparison", class: "w-full rounded-lg bg-indigo-600 px-4 py-2.5 text-sm font-semibold text-white shadow transition hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-slate-900" %>
          </div>
        <% end %>
      </li>
    <% end %>
  </ul>
<% else %>
  <p class="text-sm text-slate-500 dark:text-slate-400">No plans found. Try another search.</p>
<% end %>
